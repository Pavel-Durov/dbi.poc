<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DynamoRIO API: dr_inject.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="contents">
<h1>dr_inject.h File Reference</h1>Injection API for Windows. Use these functions to launch processes under the control of under DynamoRIO.  
<a href="dr__inject_8h.html#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dr__inject_8h.html#489c41b736afced8b2250e83d982fea9">dr_inject_process_create</a> (const char *app_name, const char *app_cmdline, void **data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dr__inject_8h.html#fe60a6d3a28c5a4c11fae5465f4f4f6a">dr_inject_process_inject</a> (void *data, bool force_injection, const char *library_path)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dr__inject_8h.html#64794d7edc3c5933c46acaa2f9a0e401">dr_inject_process_run</a> (void *data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dr__inject_8h.html#9e178716fcf1a6245f948d669292c277">dr_inject_process_exit</a> (void *data, bool terminate)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dr__inject_8h.html#7527cb5b209dd00696e96548b7c15523">dr_inject_get_image_name</a> (void *data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">HANDLE&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dr__inject_8h.html#165c3bf3fa57716d29f3b3f99a84d350">dr_inject_get_process_handle</a> (void *data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">process_id_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dr__inject_8h.html#dbed6c6df7fe011fe7bcfa40f874153b">dr_inject_get_process_id</a> (void *data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dr__inject_8h.html#0a88c9ac3f6ddc3af6a49b78810f6b70">dr_inject_print_stats</a> (void *data, int elapsed_secs, bool showstats, bool showmem)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Injection API for Windows. Use these functions to launch processes under the control of under DynamoRIO. 
<p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="7527cb5b209dd00696e96548b7c15523"></a><!-- doxytag: member="dr_inject.h::dr_inject_get_image_name" ref="7527cb5b209dd00696e96548b7c15523" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* dr_inject_get_image_name           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the process name of a process created by <a class="el" href="dr__inject_8h.html#489c41b736afced8b2250e83d982fea9">dr_inject_process_create()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>The pointer returned by <a class="el" href="dr__inject_8h.html#489c41b736afced8b2250e83d982fea9">dr_inject_process_create()</a></td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Returns the process name of the process. This is the file name without the path, suitable for passing to <a class="el" href="dr__config_8h.html#303f226bbb38a435a622e9186627b427">dr_register_process()</a>. </dd></dl>

</div>
</div><p>
<a class="anchor" name="165c3bf3fa57716d29f3b3f99a84d350"></a><!-- doxytag: member="dr_inject.h::dr_inject_get_process_handle" ref="165c3bf3fa57716d29f3b3f99a84d350" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HANDLE dr_inject_get_process_handle           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns a handle to a process created by <a class="el" href="dr__inject_8h.html#489c41b736afced8b2250e83d982fea9">dr_inject_process_create()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>The pointer returned by <a class="el" href="dr__inject_8h.html#489c41b736afced8b2250e83d982fea9">dr_inject_process_create()</a></td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Returns the handle used by drinjectlib. Do not close the handle: it will be closed in <a class="el" href="dr__inject_8h.html#9e178716fcf1a6245f948d669292c277">dr_inject_process_exit()</a>. </dd></dl>

</div>
</div><p>
<a class="anchor" name="dbed6c6df7fe011fe7bcfa40f874153b"></a><!-- doxytag: member="dr_inject.h::dr_inject_get_process_id" ref="dbed6c6df7fe011fe7bcfa40f874153b" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">process_id_t dr_inject_get_process_id           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the pid of a process created by <a class="el" href="dr__inject_8h.html#489c41b736afced8b2250e83d982fea9">dr_inject_process_create()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>The pointer returned by <a class="el" href="dr__inject_8h.html#489c41b736afced8b2250e83d982fea9">dr_inject_process_create()</a></td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Returns the pid of the process. </dd></dl>

</div>
</div><p>
<a class="anchor" name="0a88c9ac3f6ddc3af6a49b78810f6b70"></a><!-- doxytag: member="dr_inject.h::dr_inject_print_stats" ref="0a88c9ac3f6ddc3af6a49b78810f6b70" args="(void *data, int elapsed_secs, bool showstats, bool showmem)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dr_inject_print_stats           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>elapsed_secs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>showstats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>showmem</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Prints statistics for a process created by <a class="el" href="dr__inject_8h.html#489c41b736afced8b2250e83d982fea9">dr_inject_process_create()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>The pointer returned by <a class="el" href="dr__inject_8h.html#489c41b736afced8b2250e83d982fea9">dr_inject_process_create()</a></td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>elapsed_secs</em>&nbsp;</td><td>Elapsed time recorded by the caller that will be printed by this routine if showstats is true.</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>showstats</em>&nbsp;</td><td>If true, elapsed_secs and resource usage is printed.</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>showmem</em>&nbsp;</td><td>If true, memory usage statistics are printed. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="489c41b736afced8b2250e83d982fea9"></a><!-- doxytag: member="dr_inject.h::dr_inject_process_create" ref="489c41b736afced8b2250e83d982fea9" args="(const char *app_name, const char *app_cmdline, void **data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dr_inject_process_create           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>app_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>app_cmdline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a new process for the executable and command line specified. The initial thread in the process is suspended. Use <a class="el" href="dr__inject_8h.html#fe60a6d3a28c5a4c11fae5465f4f4f6a">dr_inject_process_inject()</a> to inject DynamoRIO into the process (first calling <a class="el" href="dr__config_8h.html#303f226bbb38a435a622e9186627b427">dr_register_process()</a> to configure the process, for one-time targeted configuration), <a class="el" href="dr__inject_8h.html#64794d7edc3c5933c46acaa2f9a0e401">dr_inject_process_run()</a> to resume the thread, and <a class="el" href="dr__inject_8h.html#9e178716fcf1a6245f948d669292c277">dr_inject_process_exit()</a> to finish and free resources.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>app_name</em>&nbsp;</td><td>The path to the target executable.</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>app_cmdline</em>&nbsp;</td><td>The target executable and its arguments.</td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>An opaque pointer that should be passed to subsequent dr_inject_* routines to refer to this process. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Returns 0 on success. On failure, returns a Windows API error code. Regardless of success, caller must call <a class="el" href="dr__inject_8h.html#9e178716fcf1a6245f948d669292c277">dr_inject_process_exit()</a> when finished to clean up internally-allocated resources. </dd></dl>

</div>
</div><p>
<a class="anchor" name="9e178716fcf1a6245f948d669292c277"></a><!-- doxytag: member="dr_inject.h::dr_inject_process_exit" ref="9e178716fcf1a6245f948d669292c277" args="(void *data, bool terminate)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dr_inject_process_exit           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>terminate</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Frees resources used by <a class="el" href="dr__inject_8h.html#489c41b736afced8b2250e83d982fea9">dr_inject_process_create()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>The pointer returned by <a class="el" href="dr__inject_8h.html#489c41b736afced8b2250e83d982fea9">dr_inject_process_create()</a></td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>terminate</em>&nbsp;</td><td>If true, the process is forcibly terminated.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Returns the exit code of the process. If the caller did not wait for the process to finish before calling this, the code will be STILL_ACTIVE. </dd></dl>

</div>
</div><p>
<a class="anchor" name="fe60a6d3a28c5a4c11fae5465f4f4f6a"></a><!-- doxytag: member="dr_inject.h::dr_inject_process_inject" ref="fe60a6d3a28c5a4c11fae5465f4f4f6a" args="(void *data, bool force_injection, const char *library_path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool dr_inject_process_inject           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>force_injection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>library_path</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Injects DynamoRIO into a process created by <a class="el" href="dr__inject_8h.html#489c41b736afced8b2250e83d982fea9">dr_inject_process_create()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>The pointer returned by <a class="el" href="dr__inject_8h.html#489c41b736afced8b2250e83d982fea9">dr_inject_process_create()</a></td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>force_injection</em>&nbsp;</td><td>Requests injection even if the process is configured to not be run under DynamoRIO.</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>library_path</em>&nbsp;</td><td>The path to the DynamoRIO library to use. If NULL, the library that the target process is configured for will be used.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Whether successful. </dd></dl>

</div>
</div><p>
<a class="anchor" name="64794d7edc3c5933c46acaa2f9a0e401"></a><!-- doxytag: member="dr_inject.h::dr_inject_process_run" ref="64794d7edc3c5933c46acaa2f9a0e401" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool dr_inject_process_run           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Resumes the suspended thread in a process created by <a class="el" href="dr__inject_8h.html#489c41b736afced8b2250e83d982fea9">dr_inject_process_create()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>The pointer returned by <a class="el" href="dr__inject_8h.html#489c41b736afced8b2250e83d982fea9">dr_inject_process_create()</a></td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Whether successful. </dd></dl>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: center;"><small>
<img border=0 src="favicon.png"> &nbsp; DynamoRIO API version 2.0.0 --- Thu Apr 22 00:18:17 2010 
&nbsp; <img border=0 src="favicon.png">
</body>
</html>
