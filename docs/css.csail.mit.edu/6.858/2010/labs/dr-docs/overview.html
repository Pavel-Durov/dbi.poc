<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DynamoRIO API: DynamoRIO System Details</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="contents">
<h1><a class="anchor" name="overview">DynamoRIO System Details </a></h1>DynamoRIO is a system for runtime code manipulation that is efficient, transparent, and comprehensive, able to observe and manipulate every executed instruction in an unmodified application running on a stock operating system and commodity hardware.<h2><a class="anchor" name="sec_intro">
Introduction</a></h2>
DynamoRIO operates in user mode on a target process. It acts as a <em>process virtual machine</em>, interposing between the application and the operating system. It has a complete view of the application code stream and acts as a runtime control point, allowing custom tools to be embedded inside it:<p>
<div align="center">
<img src="interpose.png" alt="interpose.png">
</div>
  <p>
The application itself, along with the underlying operating system and hardware, remain unchanged. DynamoRIO operates in native (non-virtual) environments as well as inside guest operating systems running on virtual machines. Tools created on top of DynamoRIO will operate without change whether the underlying operating system is native or a virtual machine guest.<h2><a class="anchor" name="sec_system">
System Operation</a></h2>
DynamoRIO operates by shifting an application's execution from its original instructions to a <em>code cache</em>, where the instructions can be freely modified. DynamoRIO occupies the address space with the application and has full control over execution, taking over whenever control leaves the code cache or when the operating system directly transfers control to the application (<em>kernel-mediated control transfers</em>):<p>
<div align="center">
<img src="flow-highlevel.png" alt="flow-highlevel.png">
</div>
  <p>
DynamoRIO copies the application code one <em>dynamic basic block</em> at a time into its basic block code cache. A block that directly targets another block already resident in the cache is linked to that block to avoid the cost of returning to the DynamoRIO dispatcher.<p>
Frequently executed sequences of basic blocks are combined into <em>traces</em>, which are placed in a separate code cache. DynamoRIO makes these traces available via its interface for convenient access to hot application code streams.<p>
The following figure shows the flow of control between the components of DynamoRIO and its code caches:<p>
<div align="center">
<img src="flow.png" alt="flow.png">
</div>
  <p>
The context switch is between DynamoRIO's operational state and the machine state of the application: both are still within the same process.<p>
Indirect branches require dynamic resolution of their targets, which is performed via an inlined table lookup or a compare to a known target inlined into a trace.<h2><a class="anchor" name="sec_sys_transp">
Transparency</a></h2>
Transparency is an important requirement for DynamoRIO and its clients. The subject is fully covered in <a class="el" href="transparency.html">Client Transparency</a>.<h2><a class="anchor" name="sec_refs">
References</a></h2>
The canonical reference for DynamoRIO is:<p>
<ul>
<li>Derek Bruening.<br>
 <a href="http://www.burningcutlery.com/derek/phd.html">Efficient, Transparent, and Comprehensive Runtime Code Manipulation</a>.<br>
 Ph.D. Thesis, MIT, September 2004.</li></ul>
<p>
Other publications describing DynamoRIO include:<p>
<ul>
<li>Derek Bruening and Vladimir Kiriansky.<br>
 <a href="http://www.burningcutlery.com/derek/docs/procshared-VEE08.pdf">Process-Shared and Persistent Code Caches</a>.<br>
 International Conference on Virtual Execution Environments (VEE-08), March 2008.<br>
</li></ul>
<p>
<ul>
<li>Derek Bruening, Vladimir Kiriansky, Timothy Garnett, and Sanjeev Banerji.<br>
 <a href="http://www.burningcutlery.com/derek/docs/threadshared-CGO06.pdf">Thread-Shared Software Code Caches</a>.<br>
 International Symposium on Code Generation and Optimization (CGO-06), March 2006.<br>
</li></ul>
<p>
<ul>
<li>Derek Bruening and Saman Amarasinghe. <br>
 <a href="http://www.burningcutlery.com/derek/docs/cacheconscap-CGO05.pdf">Maintaining Consistency and Bounding Capacity of Software Code Caches</a>.<br>
 International Symposium on Code Generation and Optimization (CGO-05), March 2005. <br>
</li></ul>
<p>
<ul>
<li>Gregory Sullivan, Derek Bruening, Iris Baron, Timothy Garnett, and Saman Amarasinghe. <br>
 <a href="http://www.burningcutlery.com/derek/docs/IVME03.pdf">Dynamic Native Optimization of Interpreters</a>. <br>
 ACM Workshop on Interpreters, Virtual Machines and Emulators (IVME-03), June 2003.<br>
</li></ul>
<p>
<ul>
<li>Derek Bruening, Timothy Garnett, and Saman Amarasinghe. <br>
 <a href="http://www.burningcutlery.com/derek/docs/adaptive-CGO03.pdf">An Infrastructure for Adaptive Dynamic Optimization</a>. <br>
 International Symposium on Code Generation and Optimization (CGO-03), March 2003. <br>
</li></ul>
<p>
<ul>
<li>Derek Bruening, Evelyn Duesterwald, and Saman Amarasinghe.<br>
 <a href="http://www.burningcutlery.com/derek/docs/win32-FDDO.pdf">Design and Implementation of a Dynamic Optimization Framework for Windows</a>.<br>
 4th ACM Workshop on Feedback-Directed and Dynamic Optimization (FDDO-4), December 2001.<br>
</li></ul>
<p>
<div align="center">
<img src="favicon.ico" alt="favicon.ico">
</div>
 </div>
<hr size="1"><address style="text-align: center;"><small>
<img border=0 src="favicon.png"> &nbsp; DynamoRIO API version 2.0.0 --- Thu Apr 22 00:18:19 2010 
&nbsp; <img border=0 src="favicon.png">
</body>
</html>
