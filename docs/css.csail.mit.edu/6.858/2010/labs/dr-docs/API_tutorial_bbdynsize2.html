<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DynamoRIO API: </title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="contents">
Now we register for events we'll need. For our first pass we only need to register for the bb event (to add our instrumentation) and the exit event (to display the results). We don't need to register for trace events (as we will add our instrumentation to the constituent bbs) and we can ignore the <code>for_trace</code> and <code>translating</code> arguments to the basic block callback as our changes are deterministic and idempotent so DynamoRIO default translation will work fine.<p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include "<a class="code" href="dr__api_8h.html" title="Top-level include file for DynamoRIO API.">dr_api.h</a>"</span>

+ <span class="keyword">static</span> <span class="keywordtype">void</span>
+ event_exit(<span class="keywordtype">void</span>);
+ <span class="keyword">static</span> <a class="code" href="dr__events_8h.html#689518ac5d1ad136b13e03012702b209">dr_emit_flags_t</a>
+ event_basic_block(<span class="keywordtype">void</span> *drcontext, <span class="keywordtype">void</span> *tag, instrlist_t *bb,
+                   <span class="keywordtype">bool</span> for_trace, <span class="keywordtype">bool</span> translating);

DR_EXPORT <span class="keywordtype">void</span> 
<a class="code" href="dr__api_8h.html#20a4dc9da7f6bb9121e30bb3570c6961">dr_init</a>(<a class="code" href="dr__defines_8h.html#68540a70b4f8150a4fe6dcec91bf8825">client_id_t</a> <span class="keywordtype">id</span>)
{
+     <span class="comment">/* register events */</span>
+     <a class="code" href="dr__events_8h.html#985537df683007e1392e8a3b095ef363">dr_register_exit_event</a>(event_exit);
+     <a class="code" href="dr__events_8h.html#043a3588c4cf0c2d6838140fce530e72">dr_register_bb_event</a>(event_basic_block);
}

+ <span class="keyword">static</span> <span class="keywordtype">void</span>
+ event_exit(<span class="keywordtype">void</span>)
+ {
+     <span class="comment">/* empty */</span>
+ }
+ 
+ <span class="keyword">static</span> <a class="code" href="dr__events_8h.html#689518ac5d1ad136b13e03012702b209">dr_emit_flags_t</a>
+ event_basic_block(<span class="keywordtype">void</span> *drcontext, <span class="keywordtype">void</span> *tag, instrlist_t *bb,
+                   <span class="keywordtype">bool</span> for_trace, <span class="keywordtype">bool</span> translating)
+ {
+     <span class="comment">/* empty */</span>
+     <span class="keywordflow">return</span> <a class="code" href="dr__events_8h.html#689518ac5d1ad136b13e03012702b2097d25c4546544d1a8c0b77c69230772eb">DR_EMIT_DEFAULT</a>;
+ }
</pre></div><p>
[ <a class="el" href="API_tutorial_bbdynsize1.html">prev</a> | <a class="el" href="API_tutorial_bbdynsize3.html">next</a> ] </div>
<hr size="1"><address style="text-align: center;"><small>
<img border=0 src="favicon.png"> &nbsp; DynamoRIO API version 2.0.0 --- Thu Apr 22 00:18:19 2010 
&nbsp; <img border=0 src="favicon.png">
</body>
</html>
